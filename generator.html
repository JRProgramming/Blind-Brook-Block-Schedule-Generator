<!DOCTYPE html>
<htmL>
    <head>
        <title>Block Schedule Generator</title>
        <link href="style.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <header>
            <h1 class="pHeader">Paste your classes down below</h1>
            <textarea type="text"  class="pHeader" id="textfield" placeholder="Paste your classes" rows="15" cols="75"></textarea>
            <br class="pHeader">
            <br class="pHeader">
            <button class="pHeader" id="button" onclick="implementClass()">Submit</button>
            <div id="errorPlacement" class="pHeader"></div>
            <h3 class="sHeader" hidden>Here is your schedule</h3><br class="sHeader" hidden>
            <strong class="sHeader" hidden>If you can't see the full schedule, expand the window or use a different device with a larger screen</strong><br class="sHeader" hidden>
            <strong class="sHeader" hidden>Feel free to take a screenshot of the schedule</strong>
        </header>
        <br>
        <main>
            <table>
                <thead>
                    <tr>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                        <th><span><strong></strong></span></th>
                    </tr>
                </thead>
                <tr>
                    <td class="first" id="p1A"></td>
                    <td class="third" id="p3B"></td>
                    <td class="fifth" id="p5C"></td>
                    <td class="seventh" id="p7D"></td>
                    <td class="third" id="p3E"></td>
                    <td class="first" id="p1F"></td>
                    <td class="seventh" id="p7G"></td>
                    <td class="fifth" id="p5H"></td>
                </tr>
                <tr>
                    <td class="second" id="p2A"></td>
                    <td class="fourth" id="p4B"></td>
                    <td class="sixth" id="p6C"></td>
                    <td class="eigth" id="p8D"></td>
                    <td class="fourth" id="p4E"></td>
                    <td class="second" id="p2F"></td>
                    <td class="eigth" id="p8G"></td>
                    <td class="sixth" id="p6H"></td>
                </tr>
                <tr>
                    <td class="third" id="p3A"></td>
                    <td class="fifth" id="p5B"></td>
                    <td class="seventh" id="p7C"></td>
                    <td class="first" id="p1D"></td>
                    <td class="fifth" id="p5E"></td>
                    <td class="third" id="p3F"></td>
                    <td class="first" id="p1G"></td>
                    <td class="seventh" id="p7H"></td>
                </tr>
                <tr>
                    <td id="lunch" colspan="8"></td>
                </tr>
                <tr>
                    <td class="fourth" id="p4A"></td>
                    <td class="sixth" id="p6B"></td>
                    <td class="eigth" id="p8C"></td>
                    <td class="second" id="p2D"></td>
                    <td class="sixth" id="p6E"></td>
                    <td class="fourth" id="p4F"></td>
                    <td class="second" id="p2G"></td>
                    <td class="eigth" id="p8H"></td>
                </tr>
                <tr>
                    <td class="fifth" id="p5A"></td>
                    <td class="seventh" id="p7B"></td>
                    <td class="first" id="p1C"></td>
                    <td class="third" id="p3D"></td>
                    <td class="seventh" id="p7E"></td>
                    <td class="fifth" id="p5F"></td>
                    <td class="third" id="p3G"></td>
                    <td class="first" id="p1H"></td>
                </tr>
                <tr>
                    <td class="sixth" id="p6A"></td>
                    <td class="eigth" id="p8B"></td>
                    <td class="second" id="p2C"></td>
                    <td class="fourth" id="p4D"></td>
                    <td class="eigth" id="p8E"></td>
                    <td class="sixth" id="p6F"></td>
                    <td class="fourth" id="p4G"></td>
                    <td class="second" id="p2H"></td>
                </tr>
            </table>
        </main>
        <footer>
            <i style="position: fixed; bottom: 0; right: 0; padding: 3px;">Made by Johnny Ramirez</i>
        </footer>
    </body>
</html>
<script>
    window.onload = function() {
        document.getElementsByTagName("table")[0].style.visibility = "hidden"
        if(navigator.userAgent.indexOf("Edge") != -1 || navigator.userAgent.indexOf("MSIE") != -1)
        {
            document.body.innerHTML = "<h1>This website does not support this broswer</h1><br><h3>Please use a different web broswer (Safari and Chrome are preferable)</h3>"
        }
    }

    function implementClass() {
        for(i=0;i<document.getElementsByTagName("TD").length;i++) {
            document.getElementsByTagName("TD")[i].innerHTML = ""
        }
        if(document.getElementById("errorMessage")) {
            document.getElementById("errorMessage").style.display = "none"
        }
        var textfield = document.getElementById("textfield")
        var classes = textfield.value.split('\n');
        for(i=0; i<classes.length; i++) {
            classes[i] = classes[i].trim()
            for(_=0;_<6;_++) {
                classes[i] = classes[i].replace(' ', '')
            }
            classes[i] = classes[i].replace(/\s/g,' ').split(' ')
            var unnecessaryIndexInArray = [3, 4, 5]
            for(j=0;j<3;j++) {
                classes[i].splice(unnecessaryIndexInArray[j], 1)
            }
            for(l=0;l<classes[i][0].length;l++) {
                if(classes[i][0][l] != ",") {
                    var classData = document.getElementById("p" + classes[i][1] + classes[i][0][l])
                    if(classData != undefined) {
                        classData.innerHTML = classes[i][3] + "<br>" + classes[i][2] + "<br>" + classes[i][4]
                    }
                }
            }
        }
        for(i=0;i<document.getElementsByTagName("TD").length;i++) {
            if(document.getElementsByTagName("TD")[i].innerHTML == "") {
                document.getElementsByTagName("TD")[i].innerHTML = "Free"
            }
        }
        document.getElementById("lunch").innerHTML = "Lunch"
        var letterDays = ["A","B","C","D","E","F","G","H"]
        for(m=0;m<letterDays.length;m++) {
            document.getElementsByTagName("TH")[m].innerHTML = letterDays[m]
        }
        var header = document.getElementsByClassName("pHeader")
        for(i=0;i<header.length;i++) {
            header[i].style.display = "none"
        }
        var sHeader = document.getElementsByClassName("sHeader")
        for(i=0;i<sHeader.length;i++) {
            sHeader[i].style.display = "block"
        }
        document.getElementsByTagName("table")[0].style.visibility = "visible"
        textfield.value = null
        var errorInSchedule = checkForErrors()
        if(errorInSchedule) {
            document.getElementsByTagName("table")[0].style.visibility = "hidden"
            var header = document.getElementsByClassName("pHeader")
            for(i=0;i<header.length;i++) {
                header[i].style.display = "block"
            }
            var sHeader = document.getElementsByClassName("sHeader")
            for(i=0;i<sHeader.length;i++) {
                sHeader[i].style.display = "none"
            }
             if(document.getElementById("errorMessage")) {
                 document.getElementById("errorMessage").style.display = "block"
             } else {
                 var errorHeading = document.createElement("h3")
                 errorHeading.setAttribute("style", "color:red")
                 errorHeading.setAttribute("id", "errorMessage")
                 errorHeading.innerHTML = "Your schedule did not generate properly. Please try copying your schedule as instructed"
                 document.getElementById("errorPlacement").appendChild(errorHeading)
             }
        }
    }

    function checkForErrors() {
        var errorInSchedule = true
        for(i=0;i<document.getElementsByTagName("TD").length;i++) {
            if(!document.getElementsByTagName("TD")[i].innerHTML.includes("Free") && document.getElementsByTagName("TD")[i].innerHTML != "Lunch") {
                errorInSchedule = false
            }
        }
        for(i=0;i<document.getElementsByTagName("TD").length;i++) {
            if(document.getElementsByTagName("TD")[i].innerHTML.includes("undefined")) {
               errorInSchedule = true
            }
        }
        return errorInSchedule
    }
</script>
